# Architecture

SLiVER is a tool for the analysis of collective stigmergic systems written
in the LAbS language (https://github.com/labs-lang/labs).
SLiVER analyses a given system by first translating it into what we call an
*emulation program*, i.e., a program in some general-purpose programming
language (such as C) that describes all possible evolutions of the systems.
Then, it performs the desired analysis by reusing off-the-shelf tools for
the target language.

This document summarizes the architecture of SLiVER.

## Core components 

* `sliver.py` is the SLiVER command-line interface.

* `LabsTranslate` is the LAbS parser and program generator, and is maintained
  at https://github.com/labs-lang/labs.

## Workflow

SLiVER works by creating an instance of a `Backend` subclass (according to the
`--backend` CLI option), and then invoking the following methods in sequence:

1. `check_cli()`: verify that the CLI is a valid invocation for this backend.

2. `generate_code()`: generate the emulation program that the backend will
   verify (by calling `LabsTranslate`).

3. `get_info()`: get information about the input specification (by calling
   `LabsTranslate`).

4. `check_info()`: check that the information gathered at step 3 is valid.

5. Either `verify()` or `simulate()` (depending on the command line): run the
   analysis requested by the user.

6. `cleanup()`: remove intermediate and auxiliary files.

These methods are implemented in the base class `Backend`. Their behaviour may
be customized either by overriding them (not recommended) or by altering the
following attributes and methods in a subclass:

* `cwd`: the working directory for the backend.

* `name`: the name of the backend (for logging, etc.).

* `modalities`: an iterable (e.g., a tuple) of temporal modalities
  supported by the backend.

* `get_cmdline()`: return the command line that should be used to invoke the
  backend.

* `preprocess()`: transform the code generated by LabsTranslate before it is
  printed or written to file.

* `handle_success()`, `handle_error()`: treat the output of the analysis
  backend (e.g., translate counterexample). `handle_success()` is only called
  if the backend terminates with return code 0, `handle_error()` is called in
  all other cases.

Notice that the complete set of command-line arguments is provided to the
Backend instance (as `self.cli`).
